<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UMD 格式使用演示</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .demo-section {
            background: #f8f9fa;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            border-left: 4px solid #28a745;
        }
        .result {
            background: #e8f5e8;
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
        }
        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 6px;
            overflow-x: auto;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
        }
        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        .format-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 2px solid #dee2e6;
        }
        .esm-card {
            border-color: #007acc;
        }
        .umd-card {
            border-color: #28a745;
        }
        h3 {
            margin-top: 0;
            color: #2c3e50;
        }
    </style>
</head>
<body>
    <h1>📦 ESM + UMD 双格式支持演示</h1>

    <div class="comparison">
        <div class="format-card esm-card">
            <h3>🚀 ESM 格式 (现代浏览器)</h3>
            <p><strong>优势：</strong></p>
            <ul>
                <li>支持按需导入</li>
                <li>Tree-shaking 优化</li>
                <li>原生浏览器支持</li>
                <li>多入口支持</li>
            </ul>
            <div class="code-block">import { add } from './dist/add.js';</div>
        </div>

        <div class="format-card umd-card">
            <h3>🔧 UMD 格式 (兼容性)</h3>
            <p><strong>优势：</strong></p>
            <ul>
                <li>兼容旧版浏览器</li>
                <li>支持直接script引入</li>
                <li>CommonJS/AMD兼容</li>
                <li>全局变量可用</li>
            </ul>
            <div class="code-block">&lt;script src="./dist/index.umd.js"&gt;&lt;/script&gt;</div>
        </div>
    </div>

    <div class="demo-section">
        <h2>🎯 方式1: UMD 全局变量使用</h2>
        <div class="code-block">// 通过 script 标签引入后，全局可用
console.log('UMD 全局变量:', window.AjanuwViteBuildEsm);
console.log('add(5, 3):', AjanuwViteBuildEsm.add(5, 3));
console.log('sub(10, 4):', AjanuwViteBuildEsm.sub(10, 4));
console.log('foo(3, 4):', AjanuwViteBuildEsm.foo(3, 4));</div>
        <div id="umd-global-result" class="result">加载中...</div>
    </div>

    <div class="demo-section">
        <h2>⚡ 方式2: ESM 按需导入（对比）</h2>
        <div class="code-block">// 现代 ESM 方式，支持按需导入
import { add, sub, foo } from './dist/index.js';
console.log('ESM add(5, 3):', add(5, 3));</div>
        <div id="esm-result" class="result">加载中...</div>
    </div>

    <div class="demo-section">
        <h2>🌐 CDN 使用对比</h2>
        <div class="comparison">
            <div class="format-card umd-card">
                <h4>UMD CDN 使用</h4>
                <div class="code-block">&lt;!-- 传统方式，全局可用 --&gt;
&lt;script src="https://unpkg.com/ajanuw-vite-build-esm@1.0.0/dist/umd/index.js"&gt;&lt;/script&gt;
&lt;script&gt;
  const { add, sub, foo } = AjanuwViteBuildEsm;
  console.log(add(1, 2));
&lt;/script&gt;</div>
            </div>
            <div class="format-card esm-card">
                <h4>ESM CDN 使用</h4>
                <div class="code-block">&lt;!-- 现代方式，按需导入 --&gt;
&lt;script type="module"&gt;
  import { add } from 'https://unpkg.com/ajanuw-vite-build-esm@1.0.0/dist/esm/add.js';
  console.log(add(1, 2));
&lt;/script&gt;</div>
            </div>
        </div>
    </div>

    <div class="demo-section">
        <h2>📊 格式选择建议</h2>
        <table style="width: 100%; border-collapse: collapse;">
            <thead>
                <tr style="background: #f8f9fa;">
                    <th style="padding: 10px; border: 1px solid #dee2e6;">使用场景</th>
                    <th style="padding: 10px; border: 1px solid #dee2e6;">推荐格式</th>
                    <th style="padding: 10px; border: 1px solid #dee2e6;">原因</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td style="padding: 10px; border: 1px solid #dee2e6;">现代浏览器</td>
                    <td style="padding: 10px; border: 1px solid #dee2e6;">ESM</td>
                    <td style="padding: 10px; border: 1px solid #dee2e6;">原生支持，按需加载</td>
                </tr>
                <tr>
                    <td style="padding: 10px; border: 1px solid #dee2e6;">IE11 等旧浏览器</td>
                    <td style="padding: 10px; border: 1px solid #dee2e6;">UMD</td>
                    <td style="padding: 10px; border: 1px solid #dee2e6;">兼容性最好</td>
                </tr>
                <tr>
                    <td style="padding: 10px; border: 1px solid #dee2e6;">CDN 直接引入</td>
                    <td style="padding: 10px; border: 1px solid #dee2e6;">UMD</td>
                    <td style="padding: 10px; border: 1px solid #dee2e6;">全局变量可用</td>
                </tr>
                <tr>
                    <td style="padding: 10px; border: 1px solid #dee2e6;">构建工具项目</td>
                    <td style="padding: 10px; border: 1px solid #dee2e6;">ESM</td>
                    <td style="padding: 10px; border: 1px solid #dee2e6;">Tree-shaking 优化</td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- UMD 文件引入 -->
    <script src="./dist/umd/index.js"></script>

    <!-- 演示脚本 -->
    <script>
        // UMD 全局变量演示
        try {
            if (typeof AjanuwViteBuildEsm !== 'undefined') {
                const results = [
                    `✅ UMD 全局变量可用: ${typeof AjanuwViteBuildEsm}`,
                    `包含函数: ${Object.keys(AjanuwViteBuildEsm).join(', ')}`,
                    `add(5, 3) = ${AjanuwViteBuildEsm.add(5, 3)}`,
                    `sub(10, 4) = ${AjanuwViteBuildEsm.sub(10, 4)}`,
                    `foo(3, 4) = ${AjanuwViteBuildEsm.foo(3, 4)} (3² + 4² = 25)`
                ];
                document.getElementById('umd-global-result').textContent = results.join('\n');
            } else {
                throw new Error('AjanuwViteBuildEsm 全局变量未找到');
            }
        } catch (error) {
            document.getElementById('umd-global-result').textContent =
                `❌ UMD 加载失败: ${error.message}`;
        }

        console.log('🔧 UMD 演示');
        console.log('全局变量:', window.AjanuwViteBuildEsm);
        console.log('可用函数:', Object.keys(window.AjanuwViteBuildEsm || {}));
    </script>

    <!-- ESM 对比演示 -->
    <script type="module">
        try {
            const { add, sub, foo } = await import('./dist/esm/index.js');

            const results = [
                `✅ ESM 模块导入成功`,
                `add(5, 3) = ${add(5, 3)}`,
                `sub(10, 4) = ${sub(10, 4)}`,
                `foo(3, 4) = ${foo(3, 4)} (3² + 4² = 25)`,
                `🎯 支持按需导入，减少包体积`
            ];

            document.getElementById('esm-result').textContent = results.join('\n');

            console.log('🚀 ESM 演示');
            console.log('ESM 导入成功:', { add, sub, foo });
        } catch (error) {
            document.getElementById('esm-result').textContent =
                `❌ ESM 导入失败: ${error.message}`;
        }
    </script>
</body>
</html>